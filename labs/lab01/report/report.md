---
## Front matter
title: "Отчёт по лабораторной работе 1"
subtitle: "Подготовка лабораторного стенда"
author: "Элсаиед Адел"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Целью данной работы является приобретение практических навыков установки Rocky Linux на виртуальную машину с помощью инструмента Vagrant.

# Выполнение

## Развёртывание виртуальных машин с использованием Vagrant и VirtualBox

1. В операционной системе Windows в рабочем каталоге проекта выполнена регистрация box-образа Rocky Linux в Vagrant с помощью команды `vagrant box add rockylinux10 vagrant-virtualbox-rockylinux10-x86_64.box`. В процессе выполнения команда автоматически распаковала файл и успешно добавила box `rockylinux10` для архитектуры `amd64`.

   ![Добавление box-образа Rocky Linux](Screenshot_1.png){ #fig:001 width=80% }

2. В файле Vagrantfile была выполнена настройка параметров виртуальной машины для провайдера VirtualBox. Заданы параметры использования linked clone, объём оперативной памяти 2048 МБ, количество процессоров — 2, включение графического интерфейса, настройка видеопамяти, буфера обмена, drag-and-drop и аппаратной виртуализации.

   ![Настройка Vagrantfile](Screenshot_2.png){ #fig:002 width=80% }

3. Для автоматической инициализации пользователя был подготовлен provisioning-скрипт 01-user.sh. Скрипт выполняет проверку наличия пользователя в системе, создаёт его при отсутствии, добавляет в группу wheel, задаёт пароль и настраивает переменную окружения PS1.

   ![Скрипт создания пользователя](Screenshot_3.png){ #fig:003 width=80% }

4. Для задания имени хоста виртуальной машины был создан скрипт 01-hostname.sh, который формирует имя хоста на основе текущего имени системы и логина пользователя с использованием утилиты hostnamectl.

   ![Скрипт настройки hostname](Screenshot_4.png){ #fig:004 width=80% }

5. Выполнен запуск виртуальной машины Server. В процессе запуска произведено клонирование виртуальной машины, настройка сетевых интерфейсов и автоматическая инициализация окружения. Виртуальная машина успешно запущена и готова к работе.

   ![Запуск виртуальной машины Server](Screenshot_5.png){ #fig:005 width=80% }

6. После завершения загрузки выполнен вход в графическое окружение под созданным пользователем. Имя хоста было успешно изменено в соответствии с настройками provisioning-скрипта.

   ![Успешный вход в систему Server](Screenshot_6.png){ #fig:006 width=80% }

7. Из консоли хоста выполнено подключение к серверу по SSH. После аутентификации выполнен вход под пользователем vagrant, затем произведён переход к созданному пользователю.

   ![Подключение к серверу по SSH](Screenshot_7.png){ #fig:007 width=80% }

8. Аналогичным образом выполнен запуск виртуальной машины Client. В ходе запуска произведена настройка сетевых интерфейсов, проброс портов и инициализация системы. Виртуальная машина успешно загружена и готова к эксплуатации.

   ![Запуск виртуальной машины Client](Screenshot_8.png){ #fig:008 width=80% }

9. После проверки корректности работы обеих виртуальных машин выполнен выход из пользовательских сессий и завершение работы виртуальных машин.

# Вывод

В ходе выполнения лабораторной работы было выполнено автоматизированное развёртывание виртуальных машин Server и Client в среде VirtualBox с использованием инструмента Vagrant. С помощью Packer был создан box-образ операционной системы Rocky Linux, который зарегистрирован в Vagrant и использован для последующего развёртывания виртуальной инфраструктуры. Реализована настройка параметров виртуальных машин, автоматическое создание пользователей и конфигурирование имени хоста средствами provisioning-скриптов. Проверка показала корректный запуск виртуальных машин, успешную аутентификацию пользователей и возможность подключения по SSH. Использование Vagrant позволило существенно упростить и стандартизировать процесс развёртывания и управления виртуальной средой.

# Контрольные вопросы

**1. Для чего предназначен Vagrant?**  
Vagrant предназначен для автоматизации создания, настройки и управления виртуальными машинами. Он позволяет описывать конфигурацию виртуальной среды в виде кода, обеспечивая воспроизводимость, удобство развёртывания и единообразие окружений для разработки, тестирования и обучения.

**2. Что такое box-файл? В чём назначение Vagrantfile?**  
Box-файл — это предварительно подготовленный образ виртуальной машины, содержащий операционную систему и базовые настройки, используемый Vagrant для быстрого развёртывания виртуальных сред.  
Vagrantfile — это конфигурационный файл проекта Vagrant, в котором описываются параметры виртуальных машин: используемый box, провайдер виртуализации, сетевые настройки, ресурсы, а также provisioning-скрипты для автоматической настройки системы.

**3. Приведите описание и примеры вызова основных команд Vagrant.**  
`vagrant box add` — регистрирует box-образ в локальном репозитории Vagrant.  
`vagrant up` — создаёт и запускает виртуальную машину в соответствии с настройками Vagrantfile.  
`vagrant ssh` — выполняет подключение к виртуальной машине по SSH.  
`vagrant halt` — корректно завершает работу виртуальной машины.  
`vagrant status` — отображает текущее состояние виртуальных машин проекта.  
`vagrant destroy` — удаляет виртуальную машину и все связанные с ней ресурсы.

**4. Дайте построчные пояснения содержания файлов vagrant-rocky.pkr.hcl, ks.cfg, Vagrantfile, Makefile.**

*vagrant-rocky.pkr.hcl*  
Файл конфигурации Packer, в котором описывается процесс автоматической установки операционной системы Rocky Linux. В нём указывается тип билдера (VirtualBox), путь к ISO-образу, параметры виртуальной машины, а также сценарии provisioning, выполняемые в процессе сборки образа.

*ks.cfg*  
Файл автоматической установки (Kickstart), содержащий ответы на вопросы установщика: разметку диска, выбор пакетов, настройки сети, пользователя и пароля. Используется для полностью автоматизированной установки операционной системы без участия пользователя.

*Vagrantfile*  
Файл конфигурации Vagrant, в котором задаётся версия конфигурации, используемый box-образ, параметры провайдера VirtualBox, настройки аппаратных ресурсов, сетевые параметры и provisioning-скрипты, выполняемые при запуске виртуальных машин.

*Makefile*  
Файл сценариев сборки, предназначенный для автоматизации типовых операций проекта. Содержит цели для запуска Packer, сборки box-файла, его регистрации в Vagrant и выполнения вспомогательных команд, что упрощает управление процессом сборки и развёртывания.
