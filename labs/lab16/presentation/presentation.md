---
lang: ru-RU
title: Защита сервера с использованием Fail2ban
subtitle: Лабораторная работа №16
author:
  - Элсаиед Адел
institute:
  - Российский университет дружбы народов, Москва, Россия
date: 7 января 2026

toc: false
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
---

# Цель и задачи работы

## Цель лабораторной работы

Получение практических навыков настройки и использования программного средства Fail2ban для обеспечения базовой защиты сервера от атак типа brute force.

# Выполнение работы

## Контроль запуска Fail2ban

Выполнен мониторинг журнала Fail2ban для проверки корректности запуска сервиса и подключения к базе данных.

![Просмотр журнала Fail2ban](Screenshot_1.png){ width=70% }

## Локальная конфигурация Fail2ban

Создан файл локальной конфигурации `customisation.local`, используемый для задания пользовательских параметров защиты.

![Файл customisation.local](Screenshot_2.png){ width=70% }

## Применение конфигурации

После внесения изменений выполнен перезапуск Fail2ban.  
В журнале подтверждён запуск jail-модулей SSH.

![Журнал Fail2ban (SSH)](Screenshot_3.png){ width=70% }

## Защита Apache

Включены модули защиты веб-сервера Apache:
- защита от вредоносных ботов;
- защита от атак Shellshock;
- фильтрация подозрительных HTTP-запросов.

![Настройка HTTP-защиты](Screenshot_4.png){ width=70% }

## Проверка HTTP-защиты

После перезапуска Fail2ban в журнале зафиксирован запуск всех Apache jail-модулей.

![Журнал Fail2ban (HTTP)](Screenshot_5.png){ width=70% }

## Настройка почты

Включена защита почтовых служб:
- Postfix;
- Postfix RBL;
- Dovecot;
- Postfix SASL.

![Настройка почтовых сервисов](Screenshot_6.png){ width=70% }

## Применение настроек

После перезапуска Fail2ban подтверждён запуск jail-модулей почтовых сервисов.

![Журнал Fail2ban (Mail)](Screenshot_7.png){ width=70% }

## Статус Fail2ban

Проверен общий статус Fail2ban и список активных jail-модулей.

![Статус Fail2ban](Screenshot_8.png){ width=70% }

## Проверка блокировки SSH

Выполнена имитация атаки перебора пароля по SSH.  
Fail2ban успешно заблокировал IP-адрес клиента.

![Блокировка IP-адреса](Screenshot_9.png){ width=70% }

## Исключение доверенного IP

В конфигурации Fail2ban добавлен параметр `ignoreip` для исключения доверенного IP-адреса.

![ignoreip в конфигурации](Screenshot_11.png){ width=70% }

## Проверка ignoreip

Попытки входа с доверенного IP-адреса игнорируются Fail2ban, блокировка не применяется.

![Журнал ignoreip](Screenshot_12.png){ width=70% }

## Подготовка provisioning-скрипта

Создан каталог `protect` и размещены конфигурационные файлы Fail2ban для автоматической установки.

![Каталог protect](Screenshot_13.png){ width=70% }


## Скрипт protect.sh

![Скрипт protect.sh](Screenshot_14.png){ width=70% }

# Выводы

## Вывод

В ходе лабораторной работы выполнена настройка Fail2ban для защиты SSH, HTTP и почтовых сервисов. Проведена проверка блокировки и разблокировки IP-адресов, реализовано исключение доверенных адресов и автоматизация конфигурации с использованием Vagrant. Полученные результаты подтверждают эффективность Fail2ban как средства базовой защиты сервера от атак типа brute force.
