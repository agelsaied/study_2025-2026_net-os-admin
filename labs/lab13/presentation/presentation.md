---
lang: ru-RU
title: Настройка NFS
subtitle: Лабораторная работа №13
author:
  - Элсаиед Адел
institute:
  - Российский университет дружбы народов, Москва, Россия
date: 6 января 2026

toc: false
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
---

# Цели и задачи работы

## Цель лабораторной работы

Приобретение навыков настройки сервера NFSv4 для удалённого доступа к ресурсам и организации общего дерева каталогов в сетевой среде.

# Выполнение работы

## Установка ПО на сервере

На серверной виртуальной машине установлены необходимые пакеты для работы NFS (nfs-utils) и зависимости. Подготовлена программная база для запуска сервера NFS.

![Установка nfs-utils на сервере](Screenshot_1.png){ #fig:001 width=70% }

## Создание корня дерева NFS

Создан каталог `/srv/nfs`, который используется в качестве корневого каталога экспортируемого дерева NFS.

![Создание /srv/nfs](Screenshot_2.png){ #fig:002 width=70% }

## Экспорт общего ресурса

В файле `/etc/exports` задан экспорт каталога `/srv/nfs` с доступом только на чтение для всех узлов сети. Это обеспечивает доступ клиентам без возможности модификации данных.

![Настройка /etc/exports](Screenshot_3.png){ #fig:003 width=70% }

## SELinux и запуск службы NFS

Выполнена настройка SELinux для экспортируемого каталога и применены контексты безопасности.
Служба `nfs-server` запущена и добавлена в автозагрузку.

![Запуск и включение nfs-server](Screenshot_4.png){ #fig:004 width=70% }

## Доступ клиента к экспортам

На клиенте выполнена проверка экспортов сервера. После корректной настройки межсетевого экрана команда отображает доступные экспортируемые каталоги, подтверждая работоспособность NFS.

![Проверка экспортов showmount](Screenshot_5.png){ #fig:005 width=70% }

## Анализ RPC-служб и настройка firewall

На сервере выполнен анализ служб, участвующих в удалённом монтировании (rpcbind, mountd, statd).
Добавлены необходимые сервисы в настройки `firewalld` для корректного удалённого доступа.

![RPC-службы и настройка firewall](Screenshot_6.png){ #fig:006 width=70% }

## Монтирование NFS на клиенте

На клиенте выполнено монтирование удалённого ресурса в `/mnt/nfs`.
В выводе монтирования подтверждено использование `nfs4` и сетевые параметры соединения.

![Проверка состояния монтирования](Screenshot_7.png){ #fig:007 width=70% }

## Подключение каталога веб-сервера в дерево NFS

На сервере создан каталог `/srv/nfs/www` и выполнено bind-монтирование `/var/www` в дерево NFS.
Это позволяет публиковать контент веб-сервера через NFS без копирования данных.

![Создание /srv/nfs/www](Screenshot_8.png){ #fig:008 width=70% }

![Bind-монтирование /var/www](Screenshot_9.png){ #fig:009 width=70% }

## Проверка дерева NFS на клиенте

На клиенте проверено содержимое `/mnt/nfs`: каталог `www` отображается корректно, структура дерева NFS доступна.

![Просмотр /mnt/nfs на клиенте](Screenshot_10.png){ #fig:010 width=70% }

## Экспорт каталога www с правами записи

В `/etc/exports` добавлен экспорт `/srv/nfs/www` для подсети `192.168.0.0/16` с правами чтения/записи.
После применения экспорта доступ к каталогу проверен на клиенте.

![Экспорт /srv/nfs/www](Screenshot_11.png){ #fig:011 width=70% }

## Постоянное bind-монтирование web-каталога

В `/etc/fstab` на сервере добавлена запись для постоянного bind-монтирования, чтобы конфигурация сохранялась после перезагрузки.

![Запись в /etc/fstab для bind-монтирования](Screenshot_12.png){ #fig:012 width=70% }

## Подключение пользовательского каталога common

На сервере под пользователем создан каталог `~/common` с правами `700` и файл `user@server`.
Данный каталог предназначен для сетевой работы пользователя с ограничением доступа.

![Создание каталога common и файла](Screenshot_13.png){ #fig:013 width=70% }

## Привязка common в дерево NFS

Создан каталог `/srv/nfs/home/user` и выполнено bind-монтирование `~/common` в дерево NFS.
Права доступа сохраняются: доступ к каталогу имеет только владелец (режим 700).

![Bind-монтирование common в /srv/nfs/home/user](Screenshot_14.png){ #fig:014 width=70% }

## Экспорт пользовательского каталога

В `/etc/exports` добавлен экспорт `/srv/nfs/home/user` для сети `192.168.0.0/16` с правами чтения/записи.

![Экспорт /srv/nfs/home/user](Screenshot_15.png){ #fig:015 width=70% }

## Проверка работы пользователя на клиенте

На клиенте проверено наличие каталогов `home` и `www`. В пользовательском каталоге подтверждена возможность создания файла под пользователем.
При попытке доступа под root фиксируется ограничение доступа, что соответствует модели прав и политике безопасности.

![Проверка пользовательского каталога на клиенте](Screenshot_16.png){ #fig:016 width=70% }

# Выводы

## Вывод

В ходе работы выполнена настройка NFSv4 в виртуальной среде: настроены экспорты, SELinux и межсетевой экран, реализовано монтирование на клиенте и подключение дополнительных каталогов через bind-монтирование. Обеспечено разграничение доступа для пользовательского каталога и подтверждена корректная синхронизация данных между сервером и клиентом.
